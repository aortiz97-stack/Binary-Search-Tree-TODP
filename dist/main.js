(()=>{"use strict";function l(l){return l%2==0?l/2-1:l/2-1.5}function t(e,i,n=[]){let h,d=e,r=i;if(0===d.length&&0===r.length)return n;function u(t){h=t.shift();const e=l(h.length),i=e+1;return d=t.slice(0,e+1),r=t.slice(i),h}return void 0===d[0]&&void 0!==r[0]?h=u(r):void 0!==d[0]&&void 0===r[0]?h=u(d):d[0]<r[0]?h=d.shift():d[0]>=r[0]&&(h=r.shift()),n.push(h),t(d,r,n)}function e(i){if(i.length<2)return i;const n=l(i.length),h=n+1;return t(e(i.slice(0,n+1)),e(i.slice(h)))}const i=l=>({data:l,leftChild:null,rightChild:null,parent:null}),n=(l=>{let t=(()=>{let t=new Set(l);return t=Array.from(t),e(t)})();const n=()=>t,h=l=>{t=l},d=(l=0,t=n().length-1)=>{if(l>t)return null;const e=Math.floor((t+l)/2),h=i(n()[e]),r=d(l,e-1),u=d(e+1,t);return h.leftChild=r,h.rightChild=u,null!==r&&(r.parent=h),null!==u&&(u.parent=h),h},r=(l,t="",e=!0)=>{null!==l.rightChild&&r(l.rightChild,`${t}${e?"│   ":"    "}`,!1),console.log(`${t}${e?"└── ":"┌── "}${l.data}`),null!==l.leftChild&&r(l.leftChild,`${t}${e?"    ":"│   "}`,!0)};let u=d();const o=()=>u,s=l=>{u=l},a=(l,t=o())=>{const d=i(l);n().push(l);const r=e(Array.from(new Set(n())));h(r);const u=t;return null===u||d.data===u.data?u:d.data<u.data?null===u.leftChild?(u.leftChild=d,d.parent=u,u):a(l,u.leftChild):d.data>u.data?null===u.rightChild?(u.rightChild=d,d.parent=u,u):a(l,u.rightChild):u},C=(l,t=[o()])=>{const e=t,i=t.pop();return i.data===l?i:null===i.leftChild&&null===i.rightChild&&i.data!==l&&0===t.length?null:(null!==i.leftChild&&e.push(i.leftChild),null!==i.rightChild&&e.push(i.rightChild),C(l,e))},f=(l,t=[o().data],e=[])=>{const i=t.shift(),n=C(i);return e.includes(i)||e.push(i),0===t.length&&null===n.leftChild&&null===n.rightChild?void 0!==l?l(e):e:(null!==n.leftChild&&t.push(n.leftChild.data),null!==n.rightChild&&t.push(n.rightChild.data),f(l,t,e))},g=(l=[o().data],t=[])=>{const e=l.pop(),i=C(e);return t.includes(e)||t.push(e),null===i.leftChild&&null===i.rightChild&&0===l.length?t:(null!==i.rightChild&&l.push(i.rightChild.data),null!==i.leftChild&&l.push(i.leftChild.data),g(l,t))},p=(l=[o().data],t=[])=>{if(0===l.length)return t;const e=l.pop(),i=C(e);if(null===e){const e=l.pop();return t.push(e),p(l,t)}if(null===i)return t;if(null===i.leftChild&&null===i.rightChild){t.push(e);const i=l.pop();return void 0!==i&&t.push(i),p(l,t)}return null===i.leftChild?(null!==i.rightChild&&l.push(i.rightChild.data),t.push(e),p(l,t)):null===i.rightChild?(l.push(null),l.push(e),null!==i.leftChild&&l.push(i.leftChild.data),p(l,t)):(null!==i.rightChild&&l.push(i.rightChild.data),l.push(e),l.push(i.leftChild.data),p(l,t))},c=(l=[o().data],t=[])=>{if(0===l.length)return t;let e=l.pop(),i=C(e);return null===e&&(e=l.pop(),i=C(e)),null===i?t:null===i.leftChild&&null===i.rightChild||function(){const l=null!==i.rightChild&&null!==i.leftChild&&t.includes(i.leftChild.data)&&t.includes(i.rightChild.data),e=null!==i.rightChild&&null===i.leftChild&&t.includes(i.rightChild.data),n=null!==i.leftChild&&null===i.rightChild&&t.includes(i.leftChild.data);return l||e||n}()?(t.push(e),c(l,t)):null===i.rightChild&&null!==i.leftChild?(t.includes(e)||l.push(e),l.push(null),t.includes(i.leftChild.data)||l.push(i.leftChild.data),c(l,t)):null===i.leftChild&&null!==i.rightChild&&t.includes(i.rightChild.data)?(t.push(e),c(l,t)):(l.push(e),null===i.rightChild||t.includes(i.rightChild.data)||l.push(i.rightChild.data),null===i.leftChild||t.includes(i.leftChild.data)||l.push(i.leftChild.data),c(l,t))},N=(l,t=[{node:l,nodeHeight:0}],e=[])=>{const i=t.pop();if(e.push(i),null===i.node.leftChild&&null===i.node.rightChild&&0===t.length){let l=0;for(let t=0;t<e.length;t+=1){const i=e[t];i.nodeHeight>l&&(l=i.nodeHeight)}return l}if(null!==i.node.rightChild){const l={node:i.node.rightChild,nodeHeight:i.nodeHeight+1};t.push(l)}if(null!==i.node.leftChild){const l={node:i.node.leftChild,nodeHeight:i.nodeHeight+1};t.push(l)}return N(l,t,e)};return{getSortedArray:n,getMainRoot:o,prettyPrint:r,insertNode:a,levelOrder:f,find:C,deleteNode:l=>{const t=C(l);if(t.data===o().data){const l=Math.floor((0+n().length-1)/2);n().splice(l,1),s(d())}else if(null===t.leftChild&&null===t.rightChild){const{parent:l}=t;l.leftChild===t?l.leftChild=null:l.rightChild===t&&(l.rightChild=null),t.parent=null}else{t.parent=null;const l=l=>l===t.data,i=n().findIndex(l);n().splice(i,1);const r=e(Array.from(new Set(n())));h(r),s(d())}},preorder:g,inorder:p,postorder:c,height:N}})([1,7,4,23,8,9,4,3,5,7,9,67,6345,324]);n.insertNode(63),n.insertNode(65),n.insertNode(64),n.insertNode(0),n.insertNode(1e4),n.insertNode(-1),n.insertNode(1e5),n.insertNode(-2),n.deleteNode(-2),n.deleteNode(23),n.deleteNode(67),n.deleteNode(8),n.prettyPrint(n.getMainRoot()),console.log(n.height(n.find(-1)))})();